# Read data
library(tidyverse)
data <- read_csv("data/pedestrians.csv",
show_col_types = FALSE)
#  Pivot to long
data_long <- data %>%
pivot_longer(cols = everything(),
names_to = "location",
values_to = "count")
##  Visualise the data
# Density plot - one plot for each
ggplot(data_long, aes(x = count)) +
geom_density(fill = "cyan") +
facet_wrap(~location) +
labs(
title = "Pedestrian count distribution",
x = "Pedestrian count per day (between 12-1)",
y = "Density"
) +
theme_bw(base_size = 10)
# Density plot - combined
ggplot(data_long, aes(x = count, colour = location)) +
geom_density() +
labs(
title = "Pedestrian count distribution",
x = "Pedestrian count per day (between 12-1)",
y = "Density"
) +
theme_bw(base_size = 10)
# The density plots are effective in visualising the distribution of pedestrian counts of the three locations. Here, we see that QV Melbourne lies furthest to the right, with a higher mean and more broad spread, this indicates heavier pedestrian traffic and more daily variation. Southern Cross and Flinders Street show similar traffic patterns, both traffic levels and spread, with daily count mostly remaining between 900 - 1000.
#  Descriptive statistics
descriptive_stats <- data_long %>%
group_by(location) %>%
summarise(n = n(), mean = mean(count), var = var(count), min = min(count), q1 = quantile(count, 0.25), median = median(count), q3 = quantile(count, 0.75), max = max(count))
descriptive_stats
# Analysis...
df <- data
flinders <- data$flinders_street
southern <- data$southern_cross
set.seed(123)
B <- 10000
nA <- length(flinders)
nB <- length(southern)
diffs <- numeric(B)
for (i in 1:B) {
a_star <- sample(flinders, nA, replace = TRUE)
b_star <- sample(southern, nB, replace = TRUE)
diffs[i] <- mean(a_star) - mean(b_star)
}
boot_mean <- mean(flinders) - mean(southern)
boot_CI <- quantile(diffs, c(0.025, 0.975))
cat("Bootstrap 95% CI for mean difference:\n")
print(boot_CI)
tt <- t.test(flinders, southern, var.equal = FALSE)
print(tt)
# ---- Task 4: interval estimates for mean counts by location ----
# We use t-based CIs for the mean at each location.
# This assumes independent days and finite variance; the t CI is generally robust,
# especially with moderate sample sizes (CLT support).
library(dplyr)
library(ggplot2)
library(tidyr)
library(purrr)
# Safety: drop NAs if any
data_long_clean <- data_long %>% drop_na(count)
# t-based CI per location
ci_means_t <- data_long_clean %>%
group_by(location) %>%
summarise(
n   = n(),
mean = mean(count),
sd   = sd(count),
se   = sd / sqrt(n),
t_crit = qt(0.975, df = n - 1),
lower = mean - t_crit * se,
upper = mean + t_crit * se,
.groups = "drop"
)
ci_means_t
# Visualise the mean with 95% CI (t-based)
ggplot(ci_means_t, aes(x = reorder(location, mean), y = mean)) +
geom_point(size = 2) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.15) +
coord_flip() +
labs(
title = "Mean pedestrian counts (12–1pm) with 95% CIs",
x = "Location",
y = "Mean people per hour"
) +
theme_bw(base_size = 10)
# ---- Optional robustness: bootstrap CIs for the mean (percentile) ----
# Useful if distributions are skewed / heavy-tailed or n is small.
set.seed(42)
boot_mean_ci <- function(x, B = 10000) {
boots <- replicate(B, mean(sample(x, length(x), replace = TRUE)))
c(lower = quantile(boots, 0.025), upper = quantile(boots, 0.975))
}
ci_means_boot <- data_long_clean %>%
group_by(location) %>%
summarise(
mean = mean(count),
boot_lower = boot_mean_ci(count)[1],
boot_upper = boot_mean_ci(count)[2],
.groups = "drop"
)
ci_means_boot
# Compare t-based vs bootstrap intervals (side-by-side)
ci_compare <- ci_means_t %>%
select(location, mean, t_lower = lower, t_upper = upper) %>%
left_join(ci_means_boot %>% rename(b_lower = boot_lower, b_upper = boot_upper),
by = c("location", "mean"))
ci_compare
# Calculate 95% confidence intervals
library(dplyr)
library(ggplot2)
ci_means <- data_long %>%
group_by(location) %>%
summarise(
n = n(),
mean = mean(count),
sd = sd(count),
se = sd / sqrt(n),
t_crit = qt(0.975, df = n - 1),
lower = mean - t_crit * se,
upper = mean + t_crit * se,
.groups = "drop"
)
ci_means
# Visualisation
ggplot(ci_means, aes(x = reorder(location, mean), y = mean)) +
geom_point(size = 2) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.15) +
coord_flip() +
labs(
title = "Mean pedestrian counts (12–1 pm) with 95% confidence intervals",
x = "Location",
y = "Mean number of people"
) +
theme_bw(base_size = 10)
```{r}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, eval = TRUE, message = FALSE)
library(fireRiskR)
launch_app()
launch_app()
.rs.restartR()
devtools::install()
devtools::install("fireRiskR")
getwd()
setwd("C:/Monash/SEM2/ETC5523/assignment-4-packages-and-shiny-apps-Dhruvinn13")
library(fireRiskR)
packageVersion("fireRiskR")
launch_app()
setwd("C:/Monash/SEM2/ETC5523/assignment-4-packages-and-shiny-apps-Dhruvinn13")
file.exists("DESCRIPTION")
devtools::document()
remove.packages("fireRiskR")
devtools::install()
library(fireRiskR)
launch_app()
pkgdown::build_site()
usethis::use_pkgdown_github_pages()
